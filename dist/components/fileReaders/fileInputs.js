(()=>{function p(e,t){let r={...e,...t};return Object.keys(r).map(i=>`${i}: ${r[i]};`).join(" ")}function o({id:e,text:t,styles:r}){let i=p([],r);return`
          <div class="file-input">
              <input type="file" name="${e}" id="${e}" class="file-input-input">
              <label class="file-input-label" for="${e}" style="${i}">
                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="upload" class="svg-inline--fa fa-upload fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <path fill="currentColor" d="M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path>
                    </svg>
                  <span>${t}</span>
              </label>
          </div>
      `}function d(e){for(var t=[],r=22;r<=36;r++){for(var i={},a=2;a<=7;a++){var n=XLSX.utils.encode_cell({r,c:a}),l=e[n];i[XLSX.utils.encode_col(a)]=l?l.v:null}t.push(i)}return t}function s(e,t){sessionStorage.setItem(e,JSON.stringify(t))}function c(e){return e&&e.name.split(".").pop().toLowerCase()==="csv"}function S(e){return e&&e.name.split(".").pop().toLowerCase()==="xlsx"}function m(e){return e?c(e)?e.name.includes("dp")?!0:(Swal.fire({title:"\u5FC5\u9808\u4E0A\u50B3\u5EAB\u5B58(dp)",icon:"error"}),!1):(Swal.fire({title:"\u5FC5\u9808\u662F CSV \u6A94!",icon:"error"}),!1):(Swal.fire({title:"\u6BCF\u65E5\u9032\u92B7\u5EAB\u5B58\u4E0D\u53EF\u70BA\u7A7A!",icon:"error"}),!1)}function y(e){return e?c(e)?e.name.includes("sal")?!0:(Swal.fire({title:"\u5FC5\u9808\u4E0A\u50B3\u5EAB\u5B58(sal)",icon:"error"}),!1):(Swal.fire({title:"\u5FC5\u9808\u662F CSV \u6A94!",icon:"error"}),!1):(Swal.fire({title:"\u6BCF\u65E5\u92B7\u552E\u4E0D\u53EF\u70BA\u7A7A!",icon:"error"}),!1)}function h(e){return e?S(e)?!0:(Swal.fire({title:"\u5FC5\u9808\u662F XLSX \u6A94!",icon:"error"}),!1):(Swal.fire({title:"\u6BCF\u65E5\u7E3E\u6548\u4E0D\u53EF\u70BA\u7A7A!",icon:"error"}),!1)}$(document).ready(function(){function e(){$("#uploadedFiles").append(`
      <div id="monthStocksFileNameDisplay"></div>
      <div id="todaySellsFileNameDisplay"></div>
      <div id="dailyKpiFileNameDisplay"></div>
    `),$(".top-row").append(o({id:"monthStocks",text:"\u5EAB\u5B58",styles:{background:"#02723b"}}),o({id:"todaySells",text:"\u65E5\u92B7",styles:{background:"#02723b"}}),o({id:"dailyKpi",text:"\u7E3E\u6548",styles:{background:"#02723b"}}))}e(),$("#monthStocks").on("change",function(){var t=this.files[0];if(!m(t)){$(this).val(""),$("#monthStocksFileNameDisplay").text("");return}$("#monthStocksFileNameDisplay").text("\u9032\u92B7\u5B58 : "+t.name)}),$("#todaySells").on("change",function(){var t=this.files[0];if(!y(t)){$(this).val(""),$("#todaySellsFileNameDisplay").text("");return}$("#todaySellsFileNameDisplay").text("\u55AE\u65E5\u92B7\u8CA8 : "+t.name)}),$("#dailyKpi").on("change",function(){sessionStorage.clear();var t=this.files[0];if(!h(t)){$(this).val(""),$("#dailyKpiFileNameDisplay").text("");return}$("#dailyKpiFileNameDisplay").text("\u6BCF\u65E5\u696D\u7E3E : "+t.name);var t=this.files[0],r=new FileReader;new Promise((i,a)=>{r.onload=function(n){try{var l=n.target.result,f=XLSX.read(l,{type:"binary"}),u=d(f.Sheets.\u7E3D\u8868);console.log(u),s("summaryData",u);var v=XLSX.utils.sheet_to_json(f.Sheets.\u7C21\u96EF\u6A3A);s("dailyKpiArray",v),i()}catch(g){a(g)}},r.onerror=function(n){a(n)},r.readAsBinaryString(t)}).then(()=>{console.log("\u7E3E\u6548\u7E3D\u8868\u6210\u529F\u4E0A\u50B3")}).catch(i=>{console.error("\u7E3E\u6548\u7E3D\u8868\u4E0A\u50B3\u5931\u6557",i)})})});})();
