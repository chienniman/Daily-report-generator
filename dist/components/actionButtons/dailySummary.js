(()=>{function u(t,r){let n={...t,...r};return Object.keys(n).map(i=>`${i}: ${n[i]};`).join(" ")}function c({id:t,text:r,styles:n}){return`<button id="${t}" class="button" style="${u({"max-width":"80px",cursor:"pointer"},n)}">${r}</button>`}function o(t){var r=sessionStorage.getItem(t);return r?JSON.parse(r):null}function l(t){return t&&t.name.split(".").pop().toLowerCase()==="xlsx"}function f(t){return t?l(t)?!0:(Swal.fire({title:"\u5FC5\u9808\u662F XLSX \u6A94!",icon:"error"}),!1):(Swal.fire({title:"\u6BCF\u65E5\u7E3E\u6548\u4E0D\u53EF\u70BA\u7A7A!",icon:"error"}),!1)}$(document).ready(function(){$(".top-row").append(c({id:"dailySummary",text:"\u7E3D\u7D50",styles:{display:"none"}})),$("#dailySummary").on("click",async function(){if(!f())return;function t(){let r=o("visitedAreas"),n=r.join("\uFF0C"),a=o("summaryData").filter(e=>r.includes(e.C)).map(e=>{let S=Math.ceil(e.F),m=Math.ceil(e.G),p=(e.E*100).toFixed(2)+"%",d=(e.H*100).toFixed(2)+"%";return`${e.C}\u7684\u696D\u7E3E\u76EE\u6A19\u662F ${S}\uFF0C\u696D\u7E3E\u9054\u6210\u662F ${m}\uFF0C\u696D\u7E3E\u5360\u6BD4\u662F ${p}\uFF0C\u9054\u6210\u767E\u5206\u6BD4\u662F ${d}`}),s=`\u4ECA\u65E5\u62DC\u8A2A\u4E86${n},\u56DE\u9867\u4ECA\u65E5\u696D\u7E3E\u9054\u6210\uFF0C`;a.length>0&&(s+=a.join(";")),Swal.fire({title:"\u6BCF\u65E5\u7E3D\u7D50",text:s,icon:"success"})}t()})});})();
