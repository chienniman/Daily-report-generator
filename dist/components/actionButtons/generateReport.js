(()=>{var h=new Map([["\u5927\u7532\u5340",new Map([[83800,"\u8C50\u539F\u6210\u529F"],[89e3,"\u8C50\u539F\u5927\u8C50"],[90800,"\u795E\u5CA1\u4E94\u6B0A"],[754900,"\u53F0\u4E2D\u8C50\u540E"],[91400,"\u540E\u91CC"],[87100,"\u540E\u91CC\u6587\u660E"],[93400,"\u5927\u7532\u5FA9\u8208"],[99700,"\u5927\u7532\u7D93\u570B"],[750500,"\u5927\u7532\u6C11\u751F"],[94900,"\u5927\u7532\u5149\u660E"],[98e3,"\u5927\u7532\u7532\u540E"]])],["\u5317\u4E2D\u5340",new Map([[84700,"\u53F0\u4E2D\u535A\u9928"],[88e3,"\u53F0\u4E2D\u6771\u5149"],[87300,"\u53F0\u4E2D\u65B0\u6C11"],[80300,"\u53F0\u4E2D\u5D07\u5FB7"],[97800,"\u53F0\u4E2D\u9032\u5316"],[83500,"\u53F0\u4E2D\u6C11\u6B0A"],[83300,"\u53F0\u4E2D\u6C38\u8208"],[81800,"\u53F0\u4E2D\u4E8C\u4E2D"],[84300,"\u53F0\u4E2D\u5B78\u58EB"],[88600,"\u53F0\u4E2D\u535A\u4E8C"],[754600,"\u53F0\u4E2D\u5065\u884C"],[96e3,"\u53F0\u4E2D\u660E\u65B0"]])],["\u5317\u5C6F\u5340",new Map([[97600,"\u53F0\u4E2D\u677E\u7AF9"],[88300,"\u53F0\u4E2D\u8ECD\u592A"],[82200,"\u5317\u5C6F"],[89200,"\u53F0\u4E2D\u5927\u5751"],[81200,"\u8ECD\u529F"],[752600,"\u53F0\u4E2D\u592A\u539F"],[88200,"\u53F0\u4E2D\u677E\u4E94"],[97900,"\u53F0\u4E2D\u5357\u8208"],[85200,"\u53F0\u4E2D\u5317\u5C6F\u4E8C"],[80700,"\u53F0\u4E2D\u6771\u5C71"],[99100,"\u53F0\u4E2D\u6566\u5BCC"],[341e3,"\u53F0\u4E2D\u4E2D\u6E05"]])],["\u5317\u897F\u5340",new Map([[34e4,"\u53F0\u4E2D\u6885\u5DDD\u6771"],[85e3,"\u65C5\u9806"],[80800,"\u53F0\u4E2D\u965C\u897F"],[88900,"\u53F0\u4E2D\u56DB\u5E73"],[95200,"\u53F0\u4E2D\u5927\u9D6C"],[754800,"\u53F0\u4E2D\u6C34\u6E73"],[81500,"\u5929\u6D25"],[82e3,"\u5927\u9023"],[99e3,"\u53F0\u4E2D\u5D07\u5FB7\u516B"],[98700,"\u53F0\u4E2D\u5C71\u897F"],[98600,"\u53F0\u4E2D\u6566\u5316"],[98200,"\u53F0\u4E2D\u6CB3\u5317\u6771"],[86100,"\u53F0\u4E2D\u540E\u5E84"]])],["\u897F\u5C6F\u5340",new Map([[86200,"\u9022\u7532"],[752700,"\u53F0\u4E2D\u897F\u5C6F"],[81700,"\u4E2D\u5DE5"],[99200,"\u53F0\u4E2D\u5BF6\u6176"],[96400,"\u53F0\u4E2D\u798F\u79D1"],[87900,"\u53F0\u4E2D\u9752\u6D77"],[341200,"\u53F0\u4E2D\u798F\u96C5"]])],["\u6C99\u9E7F\u5340",new Map([[91800,"\u6C99\u9E7F"],[97300,"\u6C99\u9E7F\u5317\u52E2\u6771"],[87e3,"\u6C99\u9E7F\u5C4F\u897F"],[95e3,"\u6C99\u9E7F\u4E2D\u5C71"],[99400,"\u6E05\u6C34\u65B0\u8208"],[93300,"\u6E05\u6C34\u4E2D\u8208"],[88500,"\u6E05\u6C34\u4E94\u6B0A"],[96700,"\u6E05\u6C34\u4E2D\u5C71"],[85400,"\u6E05\u6C34\u9C32\u5CF0"],[341100,"\u6E05\u6C34\u56DB\u7DAD\u6771"]])],["\u5357\u4E2D\u5340",new Map([[86500,"\u53F0\u4E2D\u6797\u68EE"],[97100,"\u53F0\u4E2D\u5FE0\u5B5D"],[83700,"\u53F0\u4E2D\u5357\u9580"],[80400,"\u53F0\u4E2D\u5FA9\u8208"],[96900,"\u53F0\u4E2D\u5FE0\u660E\u5357"],[89700,"\u53F0\u4E2D\u5DE5\u5B78"],[89800,"\u53F0\u4E2D\u5EFA\u570B\u5357"],[83400,"\u53F0\u4E2D\u6A02\u7FA4"],[83200,"\u53F0\u4E2D\u5B78\u5E9C"],[82400,"\u5927\u667A"],[755e3,"\u53F0\u4E2D\u4E09\u6C11"],[754500,"\u53F0\u4E2D\u4EC1\u548C"]])],["\u5357\u897F\u5340",new Map([[89900,"\u53F0\u4E2D\u5927\u660C"],[95800,"\u53F0\u4E2D\u5FE0\u7FA9"],[95700,"\u53F0\u4E2D\u5E02\u653F"],[81600,"\u7CBE\u8AA0"],[82500,"\u6587\u5FC3"],[83600,"\u53F0\u4E2D\u5411\u4E0A"],[82100,"\u5FE0\u660E"],[82700,"\u53F0\u4E2D\u6587\u83EF"],[84400,"\u53F0\u4E2D\u5927\u9032"],[95500,"\u53F0\u4E2D\u6C38\u6625\u6771"],[755200,"\u53F0\u4E2D\u7F8E\u6751"],[85600,"\u53F0\u4E2D\u5927\u5FE0"]])],["\u96C5\u6F6D\u5340",new Map([[93900,"\u5927\u96C5\u96C5\u74B0"],[92900,"\u5927\u96C5\u5B78\u5E9C"],[94600,"\u5927\u96C5\u6C11\u751F"],[88100,"\u795E\u5CA1\u4E2D\u6B63"],[92700,"\u795E\u5CA1\u4E2D\u5C71"],[90200,"\u795E\u5CA1\u660C\u5E73"],[96300,"\u6F6D\u5B50\u5F97\u5929"],[93800,"\u6F6D\u5B50\u6F6D\u967D"],[97400,"\u6F6D\u5B50\u4E2D\u5C71"],[98500,"\u6F6D\u5B50\u798F\u6F6D"],[92800,"\u6F6D\u5B50"],[96600,"\u6F6D\u5B50\u6F6D\u8C50"],[85500,"\u6F6D\u5B50\u8C50\u8208"]])],["\u8C50\u539F\u5340",new Map([[94800,"\u6771\u52E2\u8C50\u52E2"],[91200,"\u6771\u52E2\u6771\u862D"],[84100,"\u65B0\u793E\u4E2D\u548C"],[87600,"\u77F3\u5CA1\u8C50\u52E2"],[93100,"\u8C50\u539F\u7530\u5FC3"],[89400,"\u8C50\u539F\u5411\u967D"],[84500,"\u8C50\u539F\u8C50\u6771"],[96500,"\u8C50\u539F\u5317\u967D"],[89300,"\u8C50\u539F\u5927\u9806"],[86300,"\u8C50\u539F\u5FE0\u5B5D"]])],["\u5927\u91CC\u5340",new Map([[95600,"\u5927\u91CC\u723D\u6587"],[91700,"\u5927\u91CC"],[99600,"\u5927\u91CC\u65B0\u8208"],[94300,"\u5857\u57CE\u91D1\u5FB7"],[87500,"\u5927\u91CC\u65B0\u82B3"],[92400,"\u9727\u5CF0\u6C11\u751F"]])],["\u592A\u5E73\u5340",new Map([[91100,"\u592A\u5E73\u6A39\u5FB7"],[90300,"\u592A\u5E73\u5B9C\u660C"],[86900,"\u592A\u5E73\u6A39\u5B5D"],[82600,"\u5341\u7532"]])],["\u9F8D\u4E95\u5340",new Map([[86600,"\u5927\u809A\u69AE\u83EF"],[86800,"\u9F8D\u4E95\u6C99\u7530"],[88800,"\u68A7\u68F2\u6587\u660C"],[85900,"\u68A7\u68F2\u6587\u5316"]])],["\u5357\u5C6F\u5340",new Map([[94200,"\u70CF\u65E5\u9577\u6625"],[93700,"\u70CF\u65E5\u4E2D\u5C71"],[340100,"\u70CF\u65E5\u74B0\u6CB3"],[89600,"\u53F0\u4E2D\u8C50\u6A02"],[86700,"\u53F0\u4E2D\u4E09\u539D"],[80500,"\u53F0\u4E2D\u9ECE\u660E"],[753e3,"\u53F0\u4E2D\u4E09\u548C"],[96200,"\u53F0\u4E2D\u6953\u6A39"],[84800,"\u53F0\u4E2D\u5DBA\u6771"],[97e3,"\u53F0\u4E2D\u60E0\u6587"],[82300,"\u53F0\u4E2D\u842C\u548C"]])],["\u5F70\u5316\u5340",new Map([[111100,"\u5F70\u5B89"],[111200,"\u4E09\u6C11"],[111300,"\u9577\u8208"],[111400,"\u5F70\u5316\u81EA\u5F37\u5357"],[115900,"\u5F70\u5316\u9032\u5FB7"],[116300,"\u5F70\u5316\u5F70\u9E7F"],[118700,"\u5F70\u5316\u5EF6\u5E73"],[118800,"\u5F70\u5316\u4E2D\u8208"],[119100,"\u5F70\u5316\u5F70\u5357"],[119200,"\u5F70\u5316\u91D1\u99AC"],[119400,"\u5F70\u5316\u4E2D\u6B63"]])]]),u=new Map([["61010960","\u5357\u50D1\u6C34\u6676\u80A5\u7682 / 200g*3\u584A"],["61010830","\u5357\u50D1\u6C34\u6676\u80A5\u7682-\u6AB8\u6AAC\u6E05\u9999 / 150g*3\u5165"],["61011125","\u5357\u50D1\u6C34\u6676\u80A5\u7682200g*6\u5165\u8D08\u5357\u50D1\u7682\u529B\u6DE8\u6D17\u8863\u6DB2\u9AD4\u7682300g / 1\u7D44"],["61020444","\u5357\u50D1\u6C34\u6676\u516D\u5408\u4E00\u9175\u7D20\u8863\u9818\u7CBE-\u6E05\u65B0\u6AB8\u6AAC / 350g"],["61010953","\u83EF\u5F37\u6C34\u6676\u80A5\u7682\u6DB2\u9AD4\u88DC\u5145\u5305-\u8F15\u67D4\u578B / 1600g"],["61010942","\u5357\u50D1\u8461\u8404\u67DA\u7C7D\u6297\u83CC\u6D17\u8863\u6DB2\u9AD4\u7682-\u7DAD\u4ED6\u547DE\u8B77\u7E96\u914D\u65B9 / 1400g"],["61010952","\u83EF\u5F37\u3000\u5357\u50D1\u6C34\u6676\u80A5\u7682\u6DB2\u4F53\u88DC\u5145\u5305\uFF0D\u6297\u83CC\u8F15\u67D4\u578B / 1500\uFF47"],["61010995","\u5357\u50D1\u6C34\u6676\u8461\u8404\u67DA\u7C7D\u6297\u83CC\u9632\u9709\u6D17\u8863\u6DB2\u9AD4\u7682\u88DC\u5145\u5305-\u5BA4\u5167\u667E(\u7DAD\u4ED6\u547DE\u8B77\u7E96) / 1200g"],["61010929","\u5357\u50D1\u6C34\u6676\u7682\u529B\u6DE8\u6D17\u8863\u6DB2\u9AD4\u7682 / 1600g"],["71210073","\u6C34\u6676\u80A5\u7682\u98DF\u5668\u6D17\u6ECC\u6DB2\u9AD4 / 1000ml"]]),v=new Map([[83800,[48,24,24,8,12,6,6,6,6,12]],[89e3,[24,12,8,8,6,6,6,6,6,12]],[90800,[24,12,8,8,6,6,6,6,6,12]],[754900,[24,12,8,8,6,6,6,6,6,12]],[91400,[24,12,8,8,6,6,6,6,6,12]],[87100,[24,12,8,8,6,6,6,6,6,12]],[93400,[24,12,8,8,6,6,6,6,6,12]],[99700,[24,12,8,8,6,6,6,6,6,12]],[750500,[24,12,8,8,6,6,6,6,6,12]],[94900,[24,12,8,8,6,6,6,6,6,12]],[98e3,[24,12,8,8,6,6,6,6,6,12]],[84700,[24,12,8,8,6,6,6,6,6,12]],[88e3,[24,12,8,8,6,6,6,6,6,12]],[87300,[24,12,8,8,6,6,6,6,6,12]],[80300,[48,24,16,8,6,6,6,6,6,12]],[97800,[24,12,8,8,6,6,6,6,6,12]],[83500,[24,12,24,8,6,6,6,6,6,12]],[83300,[24,12,8,8,6,6,6,6,6,12]],[81800,[24,12,8,8,6,6,6,6,6,12]],[84300,[24,12,8,8,6,6,6,6,6,12]],[88600,[24,12,8,8,6,6,6,6,6,12]],[754600,[24,12,8,8,6,6,6,6,6,12]],[96e3,[24,12,8,8,6,6,6,6,6,12]],[97600,[24,12,24,8,6,6,6,6,6,12]],[88300,[24,12,8,8,6,6,6,6,6,12]],[82200,[24,12,8,8,6,6,6,6,6,12]],[89200,[24,12,8,8,6,6,6,6,6,12]],[81200,[24,12,8,8,6,6,6,6,6,12]],[752600,[24,12,8,8,6,6,6,6,6,12]],[88200,[24,12,8,8,6,6,6,6,6,12]],[97900,[24,12,8,8,6,6,6,6,6,12]],[85200,[24,12,8,8,6,6,6,6,6,12]],[80700,[24,12,8,8,6,6,6,6,6,12]],[99100,[24,12,8,8,6,6,6,6,6,12]],[341e3,[24,12,8,8,6,6,6,6,6,12]],[34e4,[24,12,8,8,6,6,6,6,6,12]],[85e3,[48,12,8,8,12,6,6,6,6,12]],[80800,[24,12,8,8,12,6,6,6,6,12]],[88900,[24,12,8,8,12,6,6,6,6,12]],[95200,[24,12,8,8,6,6,6,6,6,12]],[754800,[24,12,8,8,6,6,6,6,6,12]],[81500,[24,12,8,8,6,6,6,6,6,12]],[82e3,[24,12,8,8,6,6,6,6,6,12]],[99e3,[24,12,8,8,6,6,6,6,6,12]],[98700,[24,12,8,8,6,6,6,6,6,12]],[98600,[24,12,8,8,6,6,6,6,6,12]],[98200,[24,12,8,8,6,6,6,6,6,12]],[86100,[24,24,8,8,6,6,6,6,6,12]],[86200,[24,24,8,8,6,6,6,6,6,12]],[752700,[24,12,8,8,6,6,6,6,6,12]],[81700,[48,12,8,8,6,6,6,6,6,12]],[99200,[24,12,8,8,6,6,6,6,6,12]],[96400,[24,12,8,8,6,6,6,6,6,12]],[87900,[24,12,8,8,6,6,6,6,6,12]],[341200,[24,12,8,8,6,6,6,6,6,12]],[91800,[48,12,8,8,6,6,6,6,6,12]],[97300,[24,12,8,8,6,6,6,6,6,12]],[87e3,[24,12,8,8,6,6,6,6,6,12]],[95e3,[24,12,8,8,6,6,6,6,6,12]],[99400,[24,12,8,8,6,6,6,6,6,12]],[93300,[24,12,8,8,6,6,6,6,6,12]],[88500,[24,12,8,8,6,6,6,6,6,12]],[96700,[24,12,8,8,6,6,6,6,6,12]],[85400,[24,12,8,8,6,6,6,6,6,12]],[341100,[24,12,8,8,6,6,6,6,6,12]],[86500,[24,12,8,8,6,6,6,6,6,12]],[97100,[24,12,8,8,6,6,6,6,6,12]],[83700,[24,12,8,8,6,6,6,6,6,12]],[80400,[24,12,8,8,6,6,6,6,6,12]],[96900,[24,12,8,8,6,6,6,6,6,12]],[89700,[24,12,8,8,6,6,6,6,6,12]],[89800,[24,12,8,8,6,6,6,6,6,12]],[83400,[24,12,8,8,6,6,6,6,6,12]],[83200,[24,12,8,8,6,6,6,6,6,12]],[82400,[24,12,8,8,6,6,6,6,6,12]],[755e3,[24,12,8,8,6,6,6,6,6,12]],[754500,[24,12,8,8,6,6,6,6,6,12]],[89900,[48,24,24,8,6,6,6,6,6,12]],[95800,[24,12,8,8,6,6,6,6,6,12]],[95700,[24,12,8,8,6,6,6,6,6,12]],[81600,[24,12,8,8,6,6,6,6,6,12]],[82500,[24,0,24,8,6,6,6,6,6,12]],[83600,[24,12,8,8,6,6,6,6,6,12]],[82100,[24,12,8,8,6,6,6,6,6,12]],[82700,[24,12,8,8,6,6,6,6,6,12]],[84400,[24,12,8,8,6,6,6,6,6,12]],[95500,[24,12,8,8,6,6,6,6,6,12]],[755200,[24,12,8,8,6,6,6,6,6,12]],[85600,[24,12,8,8,6,6,6,6,6,12]],[93900,[48,24,24,8,6,6,6,6,6,12]],[92900,[24,12,24,8,6,6,6,6,6,12]],[94600,[24,12,8,8,6,6,6,6,6,12]],[88100,[24,12,8,8,6,6,6,6,6,12]],[92700,[24,12,8,8,6,6,6,6,6,12]],[90200,[24,12,8,8,6,6,6,6,6,12]],[96300,[24,12,8,8,6,6,6,6,6,12]],[93800,[24,12,8,8,6,6,6,6,6,12]],[97400,[24,12,8,8,6,6,6,6,6,12]],[98500,[24,12,8,8,6,6,6,6,6,12]],[92800,[24,12,8,8,6,6,6,6,6,12]],[96600,[24,12,8,8,6,6,6,6,6,12]],[85500,[24,12,8,8,6,6,6,6,6,12]],[94800,[72,12,24,8,6,6,6,6,6,12]],[91200,[24,12,8,8,6,6,6,6,6,12]],[84100,[24,12,8,8,6,6,6,6,6,12]],[87600,[24,12,8,8,6,6,6,6,6,12]],[93100,[24,12,8,8,6,6,6,6,6,12]],[89400,[24,12,24,8,6,6,6,6,6,12]],[84500,[24,12,8,8,6,6,6,6,6,12]],[96500,[24,12,8,8,6,6,6,6,6,12]],[89300,[24,12,8,8,6,6,6,6,6,12]],[86300,[24,12,8,8,6,6,6,6,6,12]],[95600,[24,12,8,8,6,6,6,6,6,12]],[91700,[24,12,8,8,6,6,6,6,6,12]],[99600,[24,12,8,8,6,6,6,6,6,12]],[94300,[24,12,8,8,6,6,6,6,6,12]],[87500,[24,12,8,8,6,6,6,6,6,12]],[92400,[24,12,8,8,6,6,6,6,6,12]],[91100,[24,12,8,8,6,6,6,6,6,12]],[90300,[24,12,8,8,6,6,6,6,6,12]],[86900,[24,12,8,8,6,6,6,6,6,12]],[82600,[24,12,8,8,6,6,6,6,6,12]],[86600,[24,12,8,8,6,6,6,6,6,12]],[86800,[24,12,8,8,6,6,6,6,6,12]],[88800,[24,12,8,8,6,6,6,6,6,12]],[85900,[24,12,8,8,6,6,6,6,6,12]],[94200,[24,12,8,8,6,6,6,6,6,12]],[93700,[24,12,8,8,6,6,6,6,6,12]],[340100,[24,12,8,8,6,6,6,6,6,12]],[89600,[24,12,8,8,6,6,6,6,6,12]],[86700,[24,12,8,8,6,6,6,6,6,12]],[80500,[24,12,24,8,6,6,6,6,6,12]],[753e3,[24,12,8,8,6,6,6,6,6,12]],[96200,[24,12,8,8,6,6,6,6,6,12]],[84800,[24,12,8,8,6,6,6,6,6,12]],[97e3,[24,12,8,8,6,6,6,6,6,12]],[82300,[24,12,8,8,6,6,6,6,6,12]],[111100,[24,12,8,8,6,6,6,6,6,12]],[111200,[24,12,8,8,6,6,6,6,6,12]],[111300,[24,12,8,8,6,6,6,6,6,12]],[111400,[24,12,8,8,6,6,6,6,6,12]],[115900,[24,12,8,8,6,6,6,6,6,12]],[116300,[24,12,8,8,6,6,6,6,6,12]],[118700,[24,12,8,8,6,6,6,6,6,12]],[118800,[24,12,8,8,6,6,6,6,6,12]],[119100,[24,12,8,8,6,6,6,6,6,12]],[119200,[24,12,8,8,6,6,6,6,6,12]],[119400,[24,12,8,8,6,6,6,6,6,12]]]);function x(t){let e="<tr class='gray'><th>\u8655</th><th>\u5340</th><th>\u5E97\u540D</th>";return Array.from(t.values()).forEach(r=>{e+=`<th colspan=3">${r}</th>`}),e+"</tr>"}function k(t,e){sessionStorage.setItem(t,JSON.stringify(e))}function b(t){var e=sessionStorage.getItem(t);return e?JSON.parse(e):null}var w=[];function R(t,e){function r(o,n){$(`.${n.name}`).addClass("clicked-btn"),w.includes(o)||(w.push(o),k("visitedAreas",w));let s=b("dailyKpiArray");if(!s){Swal.fire({title:"\u8ACB\u5148\u4E0A\u50B3\u7576\u6708\u7E3E\u6548\u7E3D\u8868",icon:"error"});return}let a=s.find(c=>c.\u5E97\u865F===n.id.toString());if(!a){Swal.fire({title:"\u7121\u5E97\u5BB6\u8CC7\u6599",icon:"error"});return}function i(c){return c.startsWith("--")?c.replace("--","\u5C11"):"\u591A"+c}a.\u5DEE\u7570\u91D1\u984D=i(a.\u5DEE\u7570\u91D1\u984D),Swal.fire({title:"\u5F8C\u7E8C\u8FFD\u8E64\u4E8B\u9805",text:`\u9054\u6210\u7387${a["\u9054\u6210%"]}\uFF0C\u5DEE\u7570\u91D1\u984D${a.\u5DEE\u7570\u91D1\u984D}`,icon:"success"})}return $("<button>").addClass(e.name).text(e.name).css("cursor","pointer").on("click",()=>r(t,e))}function y(t,e){return $(`<td class='${t}'>`).html(`<div class="split-td"><div class="darkred-text">${e}</div></div>`)}function D(t,e,r,o,n){function s(l,p,d){let f=d.get(l.id)||[];return f[p]!==void 0?f[p]:"N/A"}function a(l,p,d){let g=(l?.[p.id]?.stockQtys||[]).find(L=>L.hasOwnProperty(d));return g?g[d]:"N/A"}function i(l,p,d){return l?.[p.id]?.sellQtys?.find(f=>f[d]!==void 0)?.[d]||"0"}let c=$("<tr>").attr("id",e.id).addClass("table-row").append($("<td>").text(" "),$("<td>").text(t),$("<td>").append(R(t,e)));return Array.from(u.values()).forEach((l,p)=>{c.append(y("threshold",s(e,p,n)),y("stock",a(r,e,l)),y("sell",i(o,e,l)))}),c}function M(t){let e="<tr class='white'><th></th><th></th><th></th>";return Array.from(t.values()).forEach(()=>{e+=`
              <th id="threshold">
                  <div class='darkred-text'>
                      \u6C34\u4F4D
                  </div>
              </th>
              <th id="stock">
                  <div class='darkred-text'>
                      \u5EAB\u5B58
                  </div>
              </th>
              <th id="sell">
                  <div class='darkred-text'>
                      \u65E5\u92B7
                  </div>
              </th>
          `}),e+"</tr>"}function C(t){$("#resultTable").append(x(t)),$("#resultTable").append(M(t))}function A(t,e,r){h.forEach((o,n)=>{o.forEach((s,a)=>{t.append(D(n,{id:a,name:s},e,r,v))})})}function T(t,e){return t.reduce((r,o)=>{let n=Number(o[3]),s=e==="monthStocks"?"stockQtys":"sellQtys",a=Number(o[e==="monthStocks"?12:8]),i=o[7];return r[n]||(r[n]={PTDPNA:o[4],stockQtys:[],sellQtys:[]}),r[n][s].push({[i]:a}),r},{})}function X(t,e){let r=Array.from(h.values()).flatMap(n=>Array.from(n.keys())),o=Array.from(u.keys());return r.includes(t)&&o.includes(e)}function I(t){return t.filter(e=>X(Number(e[3]),e[5]))}function m(t){return t&&t.name.split(".").pop().toLowerCase()==="csv"}function N(t){if(typeof FileReader>"u")return Swal.fire({title:"\u700F\u89BD\u5668\u4E0D\u652F\u63F4!",icon:"error"}),!1;if(!t)return Swal.fire({title:"\u5FC5\u9808\u9078\u64C7\u6A94\u6848!",icon:"error"}),!1;if(!m(t))return Swal.fire({title:"\u4E0D\u652F\u63F4\u7684\u6A94\u6848\u985E\u578B\uFF0C\u5FC5\u9808\u662F CSV \u6A94!",icon:"error"}),!1}$.fn.csv2arr=function(t){let e=$(this)[0].files[0];N(e);let r=new FileReader;r.readAsDataURL(e),r.onload=function(o){let n=o.target.result,s=jschardet.detect(atob(n.split(";base64,")[1])).encoding;Papa.parse(e,{encoding:s==="windows-1252"?"ANSI":s,complete:a=>{let i=a.data;i[i.length-1]===""&&i.pop(),t&&t(i)}})},r.onerror=function(){Swal.fire({title:"\u7121\u6CD5\u9810\u671F\u7684\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u5617\u8A66!",icon:"error"})}};async function S(t){return new Promise(e=>{$(`input[name=${t}]`).csv2arr(r=>{let o=T(I(r),t);e(o)})})}function E(){$("input[name=monthStocks], input[name=todaySells], input[name=dailyKpi]").val(""),$("#monthStocksFileNameDisplay, #todaySellsFileNameDisplay, #dailyKpiFileNameDisplay").text("")}function P(){$("#resultTable").empty(),$(".photo-table").empty(),$(".clicked-btn").removeClass("clicked-btn")}async function Q(){try{P();let t=await S("monthStocks"),e=await S("todaySells");C(u),A($("#resultTable"),t,e),E()}catch(t){console.error("\u5831\u8868\u751F\u6210\u932F\u8AA4",t)}}function F(){let t=$("#monthStocks").val(),e=$("#todaySells").val();return!t||!e?(Swal.fire({title:"\u5FC5\u9808\u540C\u6642\u4E0A\u50B3\u55AE\u6708\u9032\u92B7\u5B58\u8DDF\u7576\u65E5\u92B7\u552E!",icon:"error"}),!1):!m($("#monthStocks")[0].files[0])||!m($("#todaySells")[0].files[0])?(Swal.fire({title:"\u8F38\u5165\u5FC5\u9808\u662F CSV \u6A94!",icon:"error"}),!1):!0}function V(t,e){let r={...t,...e};return Object.keys(r).map(o=>`${o}: ${r[o]};`).join(" ")}function H({id:t,text:e,styles:r}){return`<button id="${t}" class="button" style="${V({"max-width":"80px",cursor:"pointer"},r)}">${e}</button>`}$(document).ready(function(){$(".top-row").append(H({id:"generateReport",text:"\u751F\u6210"}));function t(){$("#dailySummary,#exportToExcel,#reset,#searchBox").show()}$("#generateReport").on("click",async function(){F()&&(Pace.restart(),await Q(),Pace.stop(),t())})});})();
